<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">

<html lang="en">

    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Deploying kb.pmem.io to GitHub Pages using Travis-CI | kb.pmem.io</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Deploying kb.pmem.io to GitHub Pages using Travis-CI" />
<meta name="author" content="Pete Seth" />
<meta property="og:locale" content="en" />
<meta name="description" content="Persistent Memory Knowledge Base" />
<meta property="og:description" content="Persistent Memory Knowledge Base" />
<link rel="canonical" href="https://kb.pmem.io/README_Deploying_kb.pmem.io_to_GitHub_Pages_using_Travis-CI/" />
<meta property="og:url" content="https://kb.pmem.io/README_Deploying_kb.pmem.io_to_GitHub_Pages_using_Travis-CI/" />
<meta property="og:site_name" content="kb.pmem.io" />
<script type="application/ld+json">
{"description":"Persistent Memory Knowledge Base","@type":"WebPage","author":{"@type":"Person","name":"Pete Seth"},"url":"https://kb.pmem.io/README_Deploying_kb.pmem.io_to_GitHub_Pages_using_Travis-CI/","headline":"Deploying kb.pmem.io to GitHub Pages using Travis-CI","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" type="image/png" href="/uploads/favicon.png" >
  <link rel="alternate" type="application/rss+xml" title="kb.pmem.io" href="/feed.xml">
  <script src="/assets/js/main.js"></script>
  
  
</head>


    <body>

    
        <div data-uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 200">
    <nav class="uk-navbar-container">
        <div class="uk-container">
            <div data-uk-navbar>
                <div class="uk-navbar-left">
                    <a class="uk-navbar-item uk-logo uk-visible@m" href="/">kb.pmem.io</a>
                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas-docs" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Docs</span></a>
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/" >Home</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="#">Knowledge Base</a>
                                        
                                            <div class="uk-navbar-dropdown">
                                                <ul class="uk-nav uk-navbar-dropdown-nav">
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/development/">Development</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/problem/">Problem Resolution</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/howto/">How To</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/faq/">Frequently Asked Questions</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/apps/">Applications</a></li>
                                                    
                                                    
                                                </ul>
                                            </div>
                                        
                                        </li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="https://docs.pmem.io/" target="_blank" >Documentation</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="https://pmem.io/blog/" target="_blank" >Blog</a></li>
                                                                                                        
                                
                            
                        
                    </ul>
                </div>
                <div class="uk-navbar-center uk-hidden@m">
                    <a class="uk-navbar-item uk-logo" href="/">kb.pmem.io</a>
                </div>
                <div class="uk-navbar-right">
                    
                        
                            <div>
				<script async src="https://cse.google.com/cse.js?cx=013996151090288251857:odeztdey5mo"></script>
				<a class="uk-navbar-toggle" uk-search-icon href="#"></a>
            			<div class="uk-drop" uk-drop="mode: click; pos: left-center; offset: 0">
                	  	    <form method="GET" action="/search" class="uk-search uk-search-navbar uk-width-1-1">
                    			<input id="minisearch" name="q" class="uk-search-input uk-border-radius-vlarge uk-box-shadow-medium gcse-searchbox-only" type="search" placeholder="Search..." autofocus>
                		    </form>
            			</div>
                            </div>
                        
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                    </ul>

                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Menu</span></a>
                    

                </div>
            </div>
        </div>
    </nav>
</div>

    

    
<div class="uk-section">
    <div class="uk-container">

        <article class="uk-article">

            <h1 class="uk-article-title">Deploying kb.pmem.io to GitHub Pages using Travis-CI</h1>

            <div class="article-content link-primary">
                <h1 id="deploying-kbpmemio-to-github-pages-using-travis-ci">Deploying kb.pmem.io to GitHub Pages using Travis-CI</h1>

<p>This persistent memory knowledge base uses <a href="https://jekyllrb.com/">Jekyll</a> with the <a href="https://themeforest.net/item/docs-responsive-documentation-manual-jekyll-theme/21131076">Docs</a> theme. The site uses <a href="https://jekyllrb.com/docs/step-by-step/09-collections/">Jekyll collections</a> to keep documents organized within separate directories. Since there are lots of docs per collection, we need to use a paginator. The default Jekyll paginator only supports posts, not collections, so we need to use the <a href="https://github.com/sverrirs/jekyll-paginate-v2">jekyll-paginator-v2</a> which does support collections. Unfortunately, GitHub pages does not support this plugin, see <a href="https://github.com/sverrirs/jekyll-paginate-v2/issues/9">this discussion</a>. Github pages uses a limited set of plugins, listed <a href="https://pages.github.com/versions/">here</a>.</p>

<p>To get around this problem, we do not want GitHub Pages to automatically build the site for us. Instead, we need to build the site and deploy it manually, rather, having Travis-CI build and deploy it for us. These instructions are provided to deploy kb.pmem.io from scratch using this approach. It may prove useful to somebody in the future.</p>

<h2 id="initial-setup">Initial Setup</h2>

<p>Using the instructions <a href="https://stackoverflow.com/questions/28249255/how-do-i-configure-github-to-use-non-supported-jekyll-site-plugins">How do I configure GitHub to use non-supported Jekyll site plugins?</a> from Stackoverflow.</p>

<p><strong>Step 1)</strong> <a href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line">Create a Developer Personal Access Token</a> within GitHub. For Step 7 of the GitHub instructions, select only the ‘repo’ option which also includes ‘public_repo’. These are the only permissions necessary for Travis-CI.</p>

<p>Note: Please ensure you copy the key when it is generated as it’s the last time you’ll see it. This key is required for Travis-CI.</p>

<p><strong>Step 2)</strong> Follow <a href="https://docs.travis-ci.com/user/getting-started/">Travis getting started</a> guide to enable Travis for your repo.</p>

<p>View or create <code class="language-plaintext highlighter-rouge">script/cibuild</code> in the knowledge-base repository with the following content</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/env bash
# halt script on error
set -e

# Build the static site using jekyll
bundle exec jekyll build

# This file tells gh-pages that there is no need to build the site automatically
touch ./_site/.nojekyll
</code></pre></div></div>

<p>Create <code class="language-plaintext highlighter-rouge">.travis.yml</code> with the following content (modify as required)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>language: ruby
rvm:
- 2.6

before_script:
 # - gem update --system
 - gem --version
 - chmod +x ./script/cibuild # or do this locally and commit

# Assume bundler is being used, therefore
# the `install` step will run `bundle install` by default.
script: ./script/cibuild

# branch whitelist, only for GitHub Pages
branches:
  only:
  - master

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer

sudo: false # route your build to the container-based infrastructure for a faster build

deploy:
  provider: pages
  skip_cleanup: true
  keep-history: true
  local_dir: _site/  # deploy this directory containing final build
  github_token: $GITHUB_API_KEY # Set in travis-ci.org dashboard
  on:
    branch: master
</code></pre></div></div>

<p>Commit and push the change to the repository.</p>

<p><strong>Step 3)</strong> In the <code class="language-plaintext highlighter-rouge">.travis.yml</code> file we specified a secret environment variable <code class="language-plaintext highlighter-rouge">GITHUB_API_KEY</code>. Go to https://travis-ci.org/dashboard and click on the ‘knowledge-base’ repository from the ‘Active repositories’ list. If you do not see this repository, ensure you followed <a href="https://docs.travis-ci.com/user/getting-started/">Travis getting started</a> and activated the ‘knowledge-base’ repository within https://travis-ci.org/account/repositories.</p>

<p>Select ‘More Options’ -&gt; ‘Environment Variables’:</p>

<p>Name = GITHUB_API_KEY</p>

<p>Value = &lt;The developer access key you generated in Step 1 from Github&gt;</p>

<p>Branch: master</p>

<p>Click ‘Add’ to add the variable. You’re now ready to begin building the site.</p>

<p><strong>Step 4)</strong> Verify the <a href="https://github.com/pmem/knowledge-base/settings">GitHub Pages settings</a> for the repository sets the ‘Source’ to the ‘gh-pages branch’ so GitHub Pages serves the rendered static site from the correct branch (defaults to ‘master’).</p>

<h2 id="deployment-steps-after-every-push">Deployment steps (after every push):</h2>

<ol>
  <li>Make a change to the repository and push to the ‘master’ branch.</li>
  <li>Travis will build the site by executing <code class="language-plaintext highlighter-rouge">bundle exec jekyll build</code> using our script <code class="language-plaintext highlighter-rouge">script/cibuild</code> and output to the <code class="language-plaintext highlighter-rouge">_site</code> directory.</li>
  <li>The <code class="language-plaintext highlighter-rouge">_site</code> directory will be pushed to <code class="language-plaintext highlighter-rouge">gh-pages</code> branch that GitHub pages uses to serve the website.</li>
  <li>GitHub pages will serve the site as it is without building it again (because of the <code class="language-plaintext highlighter-rouge">.nojekyll</code> file). This process make take up to 15mins to complete before the website reflects the updates.</li>
</ol>

            </div>

        </article>

    </div>
</div>


    <div id="offcanvas-docs" data-uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar">

        <button class="uk-offcanvas-close" type="button" data-uk-close></button>

        
        <h5 class="uk-margin-top">Getting Started</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/installation/">Theme installation</a></li>
        
          
          
          <li class=""><a href="/docs/setup/">Basic theme setup</a></li>
        
          
          
          <li class=""><a href="/docs/navigation/">Navigation bar</a></li>
        
          
          
          <li class=""><a href="/docs/footer/">Footer options</a></li>
        
          
          
          <li class=""><a href="/docs/posts/">Creating your first post in Jekyll</a></li>
        
          
          
          <li class=""><a href="/docs/docs/">Creating docs posts</a></li>
        
          
          
          <li class=""><a href="/docs/comments/">Enabling comments (via Disqus)</a></li>
        
          
          
          <li class=""><a href="/docs/analytics/">Google Analytics</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Theme Features</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/hero/">Hero page header</a></li>
        
          
          
          <li class=""><a href="/docs/boxes/">Category boxes section</a></li>
        
          
          
          <li class=""><a href="/docs/featured/">Fearured docs section</a></li>
        
          
          
          <li class=""><a href="/docs/videos/">Video lightbox boxes section</a></li>
        
          
          
          <li class=""><a href="/docs/faq/">Frequently asked questions section</a></li>
        
          
          
          <li class=""><a href="/docs/team/">Team members section</a></li>
        
          
          
          <li class=""><a href="/docs/cta/">Call to action section</a></li>
        
          
          
          <li class=""><a href="/docs/changelog/">Creating a changelog</a></li>
        
          
          
          <li class=""><a href="/docs/contact/">Contact form (via FormSpree)</a></li>
        
          
          
          <li class=""><a href="/docs/media/">Adding media to post and doc content</a></li>
        
          
          
          <li class=""><a href="/docs/toc/">Adding table of contents to docs</a></li>
        
          
          
          <li class=""><a href="/docs/alerts/">Adding alerts to content</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Customization</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/translation/">Translation</a></li>
        
          
          
          <li class=""><a href="/docs/customize/">Customization</a></li>
        
          
          
          <li class=""><a href="/docs/development/">Development</a></li>
        
          
          
          <li class=""><a href="/docs/sources/">Sources and credits</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Help</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/support/">Contacting support</a></li>
        
        </ul>
        

    </div>
</div>


    <div id="offcanvas" data-uk-offcanvas="flip: true; overlay: true">
    <div class="uk-offcanvas-bar">

        <a class="uk-logo uk-margin-small-bottom" href="/">kb.pmem.io</a>
     
        <button class="uk-offcanvas-close" type="button" data-uk-close></button>
      
        <ul class="uk-nav uk-nav-primary uk-margin-top">
            
                

                

                
                    <li><a href="/" >Home</a></li>
                
            
                

                

                
                    <li><a href="" >Knowledge Base</a></li>
                
            
                

                

                
                    <li><a href="https://docs.pmem.io/" target="_blank" >Docs</a></li>
                
            
                

                

                
                    <li><a href="https://pmem.io/blog/" target="_blank" >Blog</a></li>
                
            
        </ul>

        <div class="uk-margin-top uk-text-center">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                













            </div>
        </div>

    </div>
</div>


    
        <!-- Footer -->
<footer class="uk-section uk-text-center uk-text-muted">
    <div class="uk-container uk-container-small">

	<!-- Site navigation links -->
        <div>
            <ul class="uk-subnav uk-flex-center">
                
            </ul>
        </div>
	<!-- Social Media Links -->
        <div class="uk-margin-medium">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                













            </div>
        </div>
	<!-- Copyright notice -->
        <div class="uk-margin-medium uk-text-small copyright link-secondary">
	    Copyright&copy; kb.pmem.io 2020. All rights reserved.
	    <!--  -->
	</div>

    </div>
</footer>
<!-- End of Footer -->

    

    

    

    </body>

</html>
