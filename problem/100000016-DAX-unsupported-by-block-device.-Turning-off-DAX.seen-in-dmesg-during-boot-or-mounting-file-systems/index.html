<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">

<html lang="en">

    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>dmesg reports “DAX unsupported by block device. Turning off DAX.” during boot or mounting file systems | kb.pmem.io</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="dmesg reports “DAX unsupported by block device. Turning off DAX.” during boot or mounting file systems" />
<meta name="author" content="Steve Scargall" />
<meta property="og:locale" content="en" />
<meta name="description" content="Applies To Linux XFS or EXT4 File Systems Systems with Persistent Memory Issue During system boot or mounting of an EXT4 or XFS filesystem, the following message may be seen in dmesg: [125.755367] XFS (pmem0): DAX enabled. Warning: EXPERIMENTAL, use at your own risk[125.763736] XFS (pmem0): DAX unsupported by block device. Turning off DAX. The filesystem should still mount, but it will not have the ‘dax’ (Direct Access) flag set as shown by the mount command: $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,inode64,noquota) Solution Check the namespace mode using ndctl list -Nu. In the following example the mode is ‘raw’: # ndctl list -Nu{ &quot;namespaces&quot;:[ { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;raw&quot;, &quot;size&quot;:&quot;704.00 MiB (738.20 MB)&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } ] } From the ndctl-create-namespace man page, ‘raw’ mode does not support DAX (Direct Access). -m, --mode= - &quot;raw&quot;: expose the namespace capacity directly with limitations. Neither a raw pmem namepace nor raw blk namespace support sector atomicity by default (see &quot;sector&quot; mode below). A raw pmem namespace may have limited to no dax support depending the kernel. In other words operations like direct-I/O targeting a dax buffer may fail for a pmem namespace in raw mode or indirect through a page-cache buffer. See &quot;fsdax&quot; and &quot;devdax&quot; mode for dax operation. The namespace needs to be changed to either ‘fsdax’ or ‘devdax’ using the following: WARNING: Changing the namespace mode will destroy any existing data. Backup all data before changing the mode. $ sudo ndctl create-namespace -f -e namespace0.0 --mode=fsdax { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;memory&quot;, &quot;size&quot;:&quot;690.00 MiB (723.52 MB)&quot;, &quot;uuid&quot;:&quot;d1cc8945-7bf7-4b57-83b5-0a79565e9c15&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } The filesystem needs to be re-created, mounted with the ‘dax’ option, then any data restored: $ sudo mkfs.xfs /dev/pmem0$ sudo mount -o dax /dev/pmem0 /mnt/pmem0 $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,dax,inode64,noquota)" />
<meta property="og:description" content="Applies To Linux XFS or EXT4 File Systems Systems with Persistent Memory Issue During system boot or mounting of an EXT4 or XFS filesystem, the following message may be seen in dmesg: [125.755367] XFS (pmem0): DAX enabled. Warning: EXPERIMENTAL, use at your own risk[125.763736] XFS (pmem0): DAX unsupported by block device. Turning off DAX. The filesystem should still mount, but it will not have the ‘dax’ (Direct Access) flag set as shown by the mount command: $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,inode64,noquota) Solution Check the namespace mode using ndctl list -Nu. In the following example the mode is ‘raw’: # ndctl list -Nu{ &quot;namespaces&quot;:[ { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;raw&quot;, &quot;size&quot;:&quot;704.00 MiB (738.20 MB)&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } ] } From the ndctl-create-namespace man page, ‘raw’ mode does not support DAX (Direct Access). -m, --mode= - &quot;raw&quot;: expose the namespace capacity directly with limitations. Neither a raw pmem namepace nor raw blk namespace support sector atomicity by default (see &quot;sector&quot; mode below). A raw pmem namespace may have limited to no dax support depending the kernel. In other words operations like direct-I/O targeting a dax buffer may fail for a pmem namespace in raw mode or indirect through a page-cache buffer. See &quot;fsdax&quot; and &quot;devdax&quot; mode for dax operation. The namespace needs to be changed to either ‘fsdax’ or ‘devdax’ using the following: WARNING: Changing the namespace mode will destroy any existing data. Backup all data before changing the mode. $ sudo ndctl create-namespace -f -e namespace0.0 --mode=fsdax { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;memory&quot;, &quot;size&quot;:&quot;690.00 MiB (723.52 MB)&quot;, &quot;uuid&quot;:&quot;d1cc8945-7bf7-4b57-83b5-0a79565e9c15&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } The filesystem needs to be re-created, mounted with the ‘dax’ option, then any data restored: $ sudo mkfs.xfs /dev/pmem0$ sudo mount -o dax /dev/pmem0 /mnt/pmem0 $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,dax,inode64,noquota)" />
<link rel="canonical" href="https://kb.pmem.io/problem/100000016-DAX-unsupported-by-block-device.-Turning-off-DAX.seen-in-dmesg-during-boot-or-mounting-file-systems/" />
<meta property="og:url" content="https://kb.pmem.io/problem/100000016-DAX-unsupported-by-block-device.-Turning-off-DAX.seen-in-dmesg-during-boot-or-mounting-file-systems/" />
<meta property="og:site_name" content="kb.pmem.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-09T23:27:26+00:00" />
<script type="application/ld+json">
{"dateModified":"2020-04-09T23:27:26+00:00","datePublished":"2020-04-09T23:27:26+00:00","description":"Applies To Linux XFS or EXT4 File Systems Systems with Persistent Memory Issue During system boot or mounting of an EXT4 or XFS filesystem, the following message may be seen in dmesg: [125.755367] XFS (pmem0): DAX enabled. Warning: EXPERIMENTAL, use at your own risk[125.763736] XFS (pmem0): DAX unsupported by block device. Turning off DAX. The filesystem should still mount, but it will not have the ‘dax’ (Direct Access) flag set as shown by the mount command: $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,inode64,noquota) Solution Check the namespace mode using ndctl list -Nu. In the following example the mode is ‘raw’: # ndctl list -Nu{ &quot;namespaces&quot;:[ { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;raw&quot;, &quot;size&quot;:&quot;704.00 MiB (738.20 MB)&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } ] } From the ndctl-create-namespace man page, ‘raw’ mode does not support DAX (Direct Access). -m, --mode= - &quot;raw&quot;: expose the namespace capacity directly with limitations. Neither a raw pmem namepace nor raw blk namespace support sector atomicity by default (see &quot;sector&quot; mode below). A raw pmem namespace may have limited to no dax support depending the kernel. In other words operations like direct-I/O targeting a dax buffer may fail for a pmem namespace in raw mode or indirect through a page-cache buffer. See &quot;fsdax&quot; and &quot;devdax&quot; mode for dax operation. The namespace needs to be changed to either ‘fsdax’ or ‘devdax’ using the following: WARNING: Changing the namespace mode will destroy any existing data. Backup all data before changing the mode. $ sudo ndctl create-namespace -f -e namespace0.0 --mode=fsdax { &quot;dev&quot;:&quot;namespace0.0&quot;, &quot;mode&quot;:&quot;memory&quot;, &quot;size&quot;:&quot;690.00 MiB (723.52 MB)&quot;, &quot;uuid&quot;:&quot;d1cc8945-7bf7-4b57-83b5-0a79565e9c15&quot;, &quot;blockdev&quot;:&quot;pmem0&quot;, &quot;numa_node&quot;:0 } The filesystem needs to be re-created, mounted with the ‘dax’ option, then any data restored: $ sudo mkfs.xfs /dev/pmem0$ sudo mount -o dax /dev/pmem0 /mnt/pmem0 $ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,dax,inode64,noquota)","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://kb.pmem.io/problem/100000016-DAX-unsupported-by-block-device.-Turning-off-DAX.seen-in-dmesg-during-boot-or-mounting-file-systems/"},"author":{"@type":"Person","name":"Steve Scargall"},"url":"https://kb.pmem.io/problem/100000016-DAX-unsupported-by-block-device.-Turning-off-DAX.seen-in-dmesg-during-boot-or-mounting-file-systems/","headline":"dmesg reports “DAX unsupported by block device. Turning off DAX.” during boot or mounting file systems","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" type="image/png" href="/uploads/favicon.png" >
  <link rel="alternate" type="application/rss+xml" title="kb.pmem.io" href="/feed.xml">
  <script src="/assets/js/main.js"></script>
  
  
</head>


    <body>

    
        <div data-uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 200">
    <nav class="uk-navbar-container">
        <div class="uk-container">
            <div data-uk-navbar>
                <div class="uk-navbar-left">
                    <a class="uk-navbar-item uk-logo uk-visible@m" href="/">kb.pmem.io</a>
                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas-docs" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Docs</span></a>
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                            
                            
                            
                                
                                    
                                        <li><a href="/" >Home</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="#">Knowledge Base</a>
                                        
                                            <div class="uk-navbar-dropdown">
                                                <ul class="uk-nav uk-navbar-dropdown-nav">
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/development/">Development</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/problem/">Problem Resolution</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/howto/">How To</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/faq/">Frequently Asked Questions</a></li>
                                                    
                                                    
                                                    
                                                        
                                                        
                                                        <li><a href="/apps/">Applications</a></li>
                                                    
                                                    
                                                </ul>
                                            </div>
                                        
                                        </li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="https://docs.pmem.io/" target="_blank" >Documentation</a></li>
                                                                                                        
                                
                            
                        
                            
                            
                            
                                
                                    
                                        <li><a href="https://pmem.io/blog/" target="_blank" >Blog</a></li>
                                                                                                        
                                
                            
                        
                    </ul>
                </div>
                <div class="uk-navbar-center uk-hidden@m">
                    <a class="uk-navbar-item uk-logo" href="/">kb.pmem.io</a>
                </div>
                <div class="uk-navbar-right">
                    
                        
                            <div>
				<script async src="https://cse.google.com/cse.js?cx=013996151090288251857:odeztdey5mo"></script>
				<a class="uk-navbar-toggle" uk-search-icon href="#"></a>
            			<div class="uk-drop" uk-drop="mode: click; pos: left-center; offset: 0">
                	  	    <form method="GET" action="/search" class="uk-search uk-search-navbar uk-width-1-1">
                    			<input id="minisearch" name="q" class="uk-search-input uk-border-radius-vlarge uk-box-shadow-medium gcse-searchbox-only" type="search" placeholder="Search..." autofocus>
                		    </form>
            			</div>
                            </div>
                        
                    

                    <ul class="uk-navbar-nav uk-visible@m">
                        
                    </ul>

                    
                        <a class="uk-navbar-toggle uk-hidden@m" href="#offcanvas" data-uk-toggle><span data-uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Menu</span></a>
                    

                </div>
            </div>
        </div>
    </nav>
</div>

    

    <div class="uk-section">
    <div class="uk-container">
        <article class="uk-article">

            <h1 class="uk-article-title">dmesg reports &quot;DAX unsupported by block device. Turning off DAX.&quot; during boot or mounting file systems</h1>

            <div class="article-content link-primary">
                <h1 id="applies-to">Applies To</h1>

<ul>
  <li>
    <p>Linux</p>
  </li>
  <li>
    <p>XFS or EXT4 File Systems</p>
  </li>
  <li>
    <p>Systems with Persistent Memory</p>
  </li>
</ul>

<h1 id="issue">Issue</h1>

<p>During system boot or mounting of an EXT4 or XFS filesystem, the following message may be seen in dmesg:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[125.755367] XFS (pmem0): DAX enabled. Warning: EXPERIMENTAL, use at your own risk[125.763736] XFS (pmem0): DAX unsupported by block device. Turning off DAX.
</code></pre></div></div>

<p>The filesystem should still mount, but it will not have the ‘dax’ (Direct Access) flag set as shown by the mount command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,inode64,noquota)
</code></pre></div></div>

<h1 id="solution">Solution</h1>

<p>Check the namespace mode using <code class="language-plaintext highlighter-rouge">ndctl list -Nu</code>. In the following example the mode is ‘raw’:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ndctl list -Nu{
"namespaces":[
    {
       "dev":"namespace0.0",
       "mode":"raw",
       "size":"704.00 MiB (738.20 MB)",
       "blockdev":"pmem0",
       "numa_node":0
    }
  ]
}
</code></pre></div></div>

<p>From the <code class="language-plaintext highlighter-rouge">ndctl-create-namespace</code> man page, ‘raw’ mode does not support DAX (Direct Access).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       -m, --mode=
           -   "raw": expose the namespace capacity directly with limitations. Neither a raw pmem namepace nor raw blk
           namespace support sector atomicity by default (see "sector" mode below). A raw pmem namespace may have limited
           to no dax support depending the kernel. In other words operations like direct-I/O targeting a dax buffer may
           fail for a pmem namespace in raw mode or indirect through a page-cache buffer. See "fsdax" and "devdax" mode
           for dax operation.
</code></pre></div></div>

<p>The namespace needs to be changed to either ‘fsdax’ or ‘devdax’ using the following:</p>

<p><strong>WARNING:</strong> Changing the namespace mode will destroy any existing data. Backup all data before changing the mode.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo ndctl create-namespace -f -e namespace0.0 --mode=fsdax
{  
	"dev":"namespace0.0",
    "mode":"memory",
    "size":"690.00 MiB (723.52 MB)",
    "uuid":"d1cc8945-7bf7-4b57-83b5-0a79565e9c15",
    "blockdev":"pmem0",
    "numa_node":0
}
</code></pre></div></div>

<p>The filesystem needs to be re-created, mounted with the ‘dax’ option, then any data restored:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo mkfs.xfs /dev/pmem0$ sudo mount -o dax /dev/pmem0 /mnt/pmem0
$ mount | grep pmem0/dev/pmem0 on /mnt/pmem0 type xfs (rw,relatime,attr2,dax,inode64,noquota)
</code></pre></div></div>

            </div>

	    <div class="article-meta">
	        <h5>Disclaimer</h5>
<div class="disclaimer" id="disclaimer">
  <p> This Support Knowledgebase provides a valuable tool for parties interested in persistent memory products and solutions to acquire information, ideas and learn from one another. Materials are provided for informational, personal, commerical, and non-commercial use and are presented "AS IS" WITHOUT WARRANTY OF ANY KIND.
</div>



<h5>Document ID</h5>
100000016



<h5>Creation Date</h5>
12 Mar 2020




	    </div>
        </article>
    </div>
</div>

<!-- Footer -->
<footer class="uk-section uk-text-center uk-text-muted">
    <div class="uk-container uk-container-small">

	<!-- Site navigation links -->
        <div>
            <ul class="uk-subnav uk-flex-center">
                
            </ul>
        </div>
	<!-- Social Media Links -->
        <div class="uk-margin-medium">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                













            </div>
        </div>
	<!-- Copyright notice -->
        <div class="uk-margin-medium uk-text-small copyright link-secondary">
	    Copyright&copy; kb.pmem.io 2020. All rights reserved.
	    <!--  -->
	</div>

    </div>
</footer>
<!-- End of Footer -->





    <div id="offcanvas-docs" data-uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar">

        <button class="uk-offcanvas-close" type="button" data-uk-close></button>

        
        <h5 class="uk-margin-top">Getting Started</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/installation/">Theme installation</a></li>
        
          
          
          <li class=""><a href="/docs/setup/">Basic theme setup</a></li>
        
          
          
          <li class=""><a href="/docs/navigation/">Navigation bar</a></li>
        
          
          
          <li class=""><a href="/docs/footer/">Footer options</a></li>
        
          
          
          <li class=""><a href="/docs/posts/">Creating your first post in Jekyll</a></li>
        
          
          
          <li class=""><a href="/docs/docs/">Creating docs posts</a></li>
        
          
          
          <li class=""><a href="/docs/comments/">Enabling comments (via Disqus)</a></li>
        
          
          
          <li class=""><a href="/docs/analytics/">Google Analytics</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Theme Features</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/hero/">Hero page header</a></li>
        
          
          
          <li class=""><a href="/docs/boxes/">Category boxes section</a></li>
        
          
          
          <li class=""><a href="/docs/featured/">Fearured docs section</a></li>
        
          
          
          <li class=""><a href="/docs/videos/">Video lightbox boxes section</a></li>
        
          
          
          <li class=""><a href="/docs/faq/">Frequently asked questions section</a></li>
        
          
          
          <li class=""><a href="/docs/team/">Team members section</a></li>
        
          
          
          <li class=""><a href="/docs/cta/">Call to action section</a></li>
        
          
          
          <li class=""><a href="/docs/changelog/">Creating a changelog</a></li>
        
          
          
          <li class=""><a href="/docs/contact/">Contact form (via FormSpree)</a></li>
        
          
          
          <li class=""><a href="/docs/media/">Adding media to post and doc content</a></li>
        
          
          
          <li class=""><a href="/docs/toc/">Adding table of contents to docs</a></li>
        
          
          
          <li class=""><a href="/docs/alerts/">Adding alerts to content</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Customization</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/translation/">Translation</a></li>
        
          
          
          <li class=""><a href="/docs/customize/">Customization</a></li>
        
          
          
          <li class=""><a href="/docs/development/">Development</a></li>
        
          
          
          <li class=""><a href="/docs/sources/">Sources and credits</a></li>
        
        </ul>
        
        <h5 class="uk-margin-top">Help</h5>
        <ul class="uk-nav uk-nav-default doc-nav">
        
          
          
          <li class=""><a href="/docs/support/">Contacting support</a></li>
        
        </ul>
        

    </div>
</div>


    <div id="offcanvas" data-uk-offcanvas="flip: true; overlay: true">
    <div class="uk-offcanvas-bar">

        <a class="uk-logo uk-margin-small-bottom" href="/">kb.pmem.io</a>
     
        <button class="uk-offcanvas-close" type="button" data-uk-close></button>
      
        <ul class="uk-nav uk-nav-primary uk-margin-top">
            
                

                

                
                    <li><a href="/" >Home</a></li>
                
            
                

                

                
                    <li><a href="" >Knowledge Base</a></li>
                
            
                

                

                
                    <li><a href="https://docs.pmem.io/" target="_blank" >Docs</a></li>
                
            
                

                

                
                    <li><a href="https://pmem.io/blog/" target="_blank" >Blog</a></li>
                
            
        </ul>

        <div class="uk-margin-top uk-text-center">
            <div data-uk-grid class="uk-child-width-auto uk-grid-small uk-flex-center uk-grid">
                













            </div>
        </div>

    </div>
</div>


    

    
        
    

    

    </body>

</html>
